Area 2 is NOT a leaf area, does have child areas.
**********Constructing Aeq and beq for Area 2.
***********
*****
Checking for bus 2.
*****
The parent of bus 2 is bus 1 at index 1.
Aeq(1, P(1)) = 1.
Aeq(1, P(2)) = -1
Aeq(19, Q(1)) = 1.
Aeq(19, Q(2)) = -1
Aeq(37, v(1)) = 1
The siblings of bus 2
include these buses: 2
at indices 1.
which makes bus 2 at index 1 as the eldest sibling.
Aeq(37, v_Full(1)) = -1
Aeq(37, P(1)) = 2*r(1, 2).
Aeq(37, Q(1)) = 2*x(1, 2).
beq(1) = (1 - 0.5*CVR_P)*(P_L(2) - P_der(2))
beq(19) = (1 - 0.5*CVR_Q)*(Q_L(2) - Q_C(2))
*****
Checking for bus 3.
*****
The parent of bus 3 is bus 2 at index 2.
Aeq(2, P(2)) = 1.
Aeq(2, P(3)) = -1
Aeq(20, Q(2)) = 1.
Aeq(20, Q(3)) = -1
Aeq(38, v(2)) = 1
The siblings of bus 3
include these buses: 3
at indices 2.
which makes bus 3 at index 2 as the eldest sibling.
Aeq(38, v_Full(2)) = -1
Aeq(38, P(2)) = 2*r(2, 3).
Aeq(38, Q(2)) = 2*x(2, 3).
beq(2) = (1 - 0.5*CVR_P)*(P_L(3) - P_der(3))
beq(20) = (1 - 0.5*CVR_Q)*(Q_L(3) - Q_C(3))
*****
Checking for bus 4.
*****
The parent of bus 4 is bus 3 at index 3.
Aeq(3, P(3)) = 1.
Aeq(3, P(4)) = -1
Aeq(21, Q(3)) = 1.
Aeq(21, Q(4)) = -1
Aeq(39, v(3)) = 1
The siblings of bus 4
include these buses: 4
at indices 3.
which makes bus 4 at index 3 as the eldest sibling.
Aeq(39, v_Full(3)) = -1
Aeq(39, P(3)) = 2*r(3, 4).
Aeq(39, Q(3)) = 2*x(3, 4).
beq(3) = (1 - 0.5*CVR_P)*(P_L(4) - P_der(4))
beq(21) = (1 - 0.5*CVR_Q)*(Q_L(4) - Q_C(4))
*****
Checking for bus 5.
*****
The parent of bus 5 is bus 4 at index 4.
Aeq(4, P(4)) = 1.
Aeq(4, P(5)) = -1
Aeq(4, P(7)) = -1
Aeq(22, Q(4)) = 1.
Aeq(22, Q(5)) = -1
Aeq(22, Q(7)) = -1
Aeq(40, v(4)) = 1
The siblings of bus 5
include these buses: 5
at indices 4.
which makes bus 5 at index 4 as the eldest sibling.
Aeq(40, v_Full(4)) = -1
Aeq(40, P(4)) = 2*r(4, 5).
Aeq(40, Q(4)) = 2*x(4, 5).
beq(4) = (1 - 0.5*CVR_P)*(P_L(5) - P_der(5))
beq(22) = (1 - 0.5*CVR_Q)*(Q_L(5) - Q_C(5))
*****
Checking for bus 6.
*****
The parent of bus 6 is bus 5 at index 5.
Aeq(5, P(5)) = 1.
Aeq(5, P(6)) = -1
Aeq(23, Q(5)) = 1.
Aeq(23, Q(6)) = -1
Aeq(41, v(5)) = 1
The siblings of bus 6
include these buses: 6
include these buses: 8
at indices 5.
at indices 7.
which makes bus 6 at index 5 as the eldest sibling.
Aeq(41, v_Full(5)) = -1
Aeq(41, P(5)) = 2*r(5, 6).
Aeq(41, Q(5)) = 2*x(5, 6).
beq(5) = (1 - 0.5*CVR_P)*(P_L(6) - P_der(6))
beq(23) = (1 - 0.5*CVR_Q)*(Q_L(6) - Q_C(6))
*****
Checking for bus 7.
*****
The parent of bus 7 is bus 6 at index 6.
Aeq(6, P(6)) = 1.
Aeq(24, Q(6)) = 1.
Aeq(42, v(6)) = 1
The siblings of bus 7
include these buses: 7
at indices 6.
which makes bus 7 at index 6 as the eldest sibling.
Aeq(42, v_Full(6)) = -1
Aeq(42, P(6)) = 2*r(6, 7).
Aeq(42, Q(6)) = 2*x(6, 7).
beq(6) = (1 - 0.5*CVR_P)*(P_L(7) - P_der(7))
beq(24) = (1 - 0.5*CVR_Q)*(Q_L(7) - Q_C(7))
*****
Checking for bus 8.
*****
The parent of bus 8 is bus 5 at index 7.
Aeq(7, P(7)) = 1.
Aeq(7, P(8)) = -1
Aeq(7, P(10)) = -1
Aeq(25, Q(7)) = 1.
Aeq(25, Q(8)) = -1
Aeq(25, Q(10)) = -1
Aeq(43, v(7)) = 1
The siblings of bus 8
include these buses: 6
include these buses: 8
at indices 5.
at indices 7.
which makes bus 6 at index 5 as the eldest sibling.
Aeq(43, v_Full(5)) = -1
Aeq(43, P(7)) = 2*r(5, 8).
Aeq(43, Q(7)) = 2*x(5, 8).
beq(7) = (1 - 0.5*CVR_P)*(P_L(8) - P_der(8))
beq(25) = (1 - 0.5*CVR_Q)*(Q_L(8) - Q_C(8))
*****
Checking for bus 9.
*****
The parent of bus 9 is bus 8 at index 8.
Aeq(8, P(8)) = 1.
Aeq(8, P(9)) = -1
Aeq(26, Q(8)) = 1.
Aeq(26, Q(9)) = -1
Aeq(44, v(8)) = 1
The siblings of bus 9
include these buses: 9
include these buses: 11
at indices 8.
at indices 10.
which makes bus 9 at index 8 as the eldest sibling.
Aeq(44, v_Full(8)) = -1
Aeq(44, P(8)) = 2*r(8, 9).
Aeq(44, Q(8)) = 2*x(8, 9).
beq(8) = (1 - 0.5*CVR_P)*(P_L(9) - P_der(9))
beq(26) = (1 - 0.5*CVR_Q)*(Q_L(9) - Q_C(9))
*****
Checking for bus 10.
*****
The parent of bus 10 is bus 9 at index 9.
Aeq(9, P(9)) = 1.
Aeq(27, Q(9)) = 1.
Aeq(45, v(9)) = 1
The siblings of bus 10
include these buses: 10
at indices 9.
which makes bus 10 at index 9 as the eldest sibling.
Aeq(45, v_Full(9)) = -1
Aeq(45, P(9)) = 2*r(9, 10).
Aeq(45, Q(9)) = 2*x(9, 10).
beq(9) = (1 - 0.5*CVR_P)*(P_L(10) - P_der(10))
beq(27) = (1 - 0.5*CVR_Q)*(Q_L(10) - Q_C(10))
*****
Checking for bus 11.
*****
The parent of bus 11 is bus 8 at index 10.
Aeq(10, P(10)) = 1.
Aeq(10, P(11)) = -1
Aeq(10, P(12)) = -1
Aeq(10, P(18)) = -1
Aeq(28, Q(10)) = 1.
Aeq(28, Q(11)) = -1
Aeq(28, Q(12)) = -1
Aeq(28, Q(18)) = -1
Aeq(46, v(10)) = 1
The siblings of bus 11
include these buses: 9
include these buses: 11
at indices 8.
at indices 10.
which makes bus 9 at index 8 as the eldest sibling.
Aeq(46, v_Full(8)) = -1
Aeq(46, P(10)) = 2*r(8, 11).
Aeq(46, Q(10)) = 2*x(8, 11).
beq(10) = (1 - 0.5*CVR_P)*(P_L(11) - P_der(11))
beq(28) = (1 - 0.5*CVR_Q)*(Q_L(11) - Q_C(11))
*****
Checking for bus 12.
*****
The parent of bus 12 is bus 11 at index 11.
Aeq(11, P(11)) = 1.
Aeq(11, P(17)) = -1
Aeq(29, Q(11)) = 1.
Aeq(29, Q(17)) = -1
Aeq(47, v(11)) = 1
The siblings of bus 12
include these buses: 12
include these buses: 13
include these buses: 19
at indices 11.
at indices 12.
at indices 18.
which makes bus 12 at index 11 as the eldest sibling.
Aeq(47, v_Full(11)) = -1
Aeq(47, P(11)) = 2*r(11, 12).
Aeq(47, Q(11)) = 2*x(11, 12).
beq(11) = (1 - 0.5*CVR_P)*(P_L(12) - P_der(12))
beq(29) = (1 - 0.5*CVR_Q)*(Q_L(12) - Q_C(12))
*****
Checking for bus 13.
*****
The parent of bus 13 is bus 11 at index 12.
Aeq(12, P(12)) = 1.
Aeq(12, P(13)) = -1
Aeq(30, Q(12)) = 1.
Aeq(30, Q(13)) = -1
Aeq(48, v(12)) = 1
The siblings of bus 13
include these buses: 12
include these buses: 13
include these buses: 19
at indices 11.
at indices 12.
at indices 18.
which makes bus 12 at index 11 as the eldest sibling.
Aeq(48, v_Full(11)) = -1
Aeq(48, P(12)) = 2*r(11, 13).
Aeq(48, Q(12)) = 2*x(11, 13).
beq(12) = (1 - 0.5*CVR_P)*(P_L(13) - P_der(13))
beq(30) = (1 - 0.5*CVR_Q)*(Q_L(13) - Q_C(13))
*****
Checking for bus 14.
*****
The parent of bus 14 is bus 13 at index 13.
Aeq(13, P(13)) = 1.
Aeq(13, P(14)) = -1
Aeq(31, Q(13)) = 1.
Aeq(31, Q(14)) = -1
Aeq(49, v(13)) = 1
The siblings of bus 14
include these buses: 14
at indices 13.
which makes bus 14 at index 13 as the eldest sibling.
Aeq(49, v_Full(13)) = -1
Aeq(49, P(13)) = 2*r(13, 14).
Aeq(49, Q(13)) = 2*x(13, 14).
beq(13) = (1 - 0.5*CVR_P)*(P_L(14) - P_der(14))
beq(31) = (1 - 0.5*CVR_Q)*(Q_L(14) - Q_C(14))
*****
Checking for bus 15.
*****
The parent of bus 15 is bus 14 at index 14.
Aeq(14, P(14)) = 1.
Aeq(14, P(15)) = -1
Aeq(32, Q(14)) = 1.
Aeq(32, Q(15)) = -1
Aeq(50, v(14)) = 1
The siblings of bus 15
include these buses: 15
at indices 14.
which makes bus 15 at index 14 as the eldest sibling.
Aeq(50, v_Full(14)) = -1
Aeq(50, P(14)) = 2*r(14, 15).
Aeq(50, Q(14)) = 2*x(14, 15).
beq(14) = (1 - 0.5*CVR_P)*(P_L(15) - P_der(15))
beq(32) = (1 - 0.5*CVR_Q)*(Q_L(15) - Q_C(15))
*****
Checking for bus 16.
*****
The parent of bus 16 is bus 15 at index 15.
Aeq(15, P(15)) = 1.
Aeq(15, P(16)) = -1
Aeq(33, Q(15)) = 1.
Aeq(33, Q(16)) = -1
Aeq(51, v(15)) = 1
The siblings of bus 16
include these buses: 16
at indices 15.
which makes bus 16 at index 15 as the eldest sibling.
Aeq(51, v_Full(15)) = -1
Aeq(51, P(15)) = 2*r(15, 16).
Aeq(51, Q(15)) = 2*x(15, 16).
beq(15) = (1 - 0.5*CVR_P)*(P_L(16) - P_der(16))
beq(33) = (1 - 0.5*CVR_Q)*(Q_L(16) - Q_C(16))
*****
Checking for bus 17.
*****
The parent of bus 17 is bus 16 at index 16.
Aeq(16, P(16)) = 1.
Aeq(34, Q(16)) = 1.
Aeq(52, v(16)) = 1
The siblings of bus 17
include these buses: 17
at indices 16.
which makes bus 17 at index 16 as the eldest sibling.
Aeq(52, v_Full(16)) = -1
Aeq(52, P(16)) = 2*r(16, 17).
Aeq(52, Q(16)) = 2*x(16, 17).
beq(16) = (1 - 0.5*CVR_P)*(P_L(17) - P_der(17))
beq(34) = (1 - 0.5*CVR_Q)*(Q_L(17) - Q_C(17))
*****
Checking for bus 18.
*****
The parent of bus 18 is bus 12 at index 17.
Aeq(17, P(17)) = 1.
Aeq(35, Q(17)) = 1.
Aeq(53, v(17)) = 1
The siblings of bus 18
include these buses: 18
at indices 17.
which makes bus 18 at index 17 as the eldest sibling.
Aeq(53, v_Full(17)) = -1
Aeq(53, P(17)) = 2*r(12, 18).
Aeq(53, Q(17)) = 2*x(12, 18).
beq(17) = (1 - 0.5*CVR_P)*(P_L(18) - P_der(18))
beq(35) = (1 - 0.5*CVR_Q)*(Q_L(18) - Q_C(18))
*****
Checking for bus 19.
*****
The parent of bus 19 is bus 11 at index 18.
Aeq(18, P(18)) = 1.
Aeq(36, Q(18)) = 1.
Aeq(54, v(18)) = 1
The siblings of bus 19
include these buses: 12
include these buses: 13
include these buses: 19
at indices 11.
at indices 12.
at indices 18.
which makes bus 12 at index 11 as the eldest sibling.
Aeq(54, v_Full(11)) = -1
Aeq(54, P(18)) = 2*r(11, 19).
Aeq(54, Q(18)) = 2*x(11, 19).
beq(18) = (1 - 0.5*CVR_P)*(P_L(19) - P_der(19))
beq(36) = (1 - 0.5*CVR_Q)*(Q_L(19) - Q_C(19))
And who can forget the substation voltage equation..
Aeq(55, v_Full(1)) = 1
beq(55) = 1.061
Now adding the required 12 coefficients to model the 12 DERs in just as many equations from among the 18 branch reactive flow equations.
Aeq(20, qD(1)) = 1
Aeq(21, qD(2)) = 1
Aeq(23, qD(3)) = 1
Aeq(24, qD(4)) = 1
Aeq(26, qD(5)) = 1
Aeq(27, qD(6)) = 1
Aeq(28, qD(7)) = 1
Aeq(30, qD(8)) = 1
Aeq(31, qD(9)) = 1
Aeq(32, qD(10)) = 1
Aeq(33, qD(11)) = 1
Aeq(34, qD(12)) = 1
Now adding the required 12 + 12 = 24 coefficients in just as many equations from among existing 18 real and 18 reactive branch flow equations, as well as 12 new equations to model the SOCs for the batteries.
Battery number 1 is actually bus number 3.
Whose parent is bus 2 at index 2.
Obviously, this additional battery will go into equation #56.
Aeq(2, Pc(1)) = -1
Aeq(2, Pd(1)) = 1
Aeq(20, qB(1)) = 1
Aeq(56, B(1)) = 1
Aeq(56, Pc(1)) = -delta_t*etta_C
Aeq(56, Pd(1)) = delta_t/etta_D
beq(56) = B0(1) = 0.053826
Battery number 2 is actually bus number 4.
Whose parent is bus 3 at index 3.
Obviously, this additional battery will go into equation #57.
Aeq(3, Pc(2)) = -1
Aeq(3, Pd(2)) = 1
Aeq(21, qB(2)) = 1
Aeq(57, B(2)) = 1
Aeq(57, Pc(2)) = -delta_t*etta_C
Aeq(57, Pd(2)) = delta_t/etta_D
beq(57) = B0(2) = 0.053826
Battery number 3 is actually bus number 6.
Whose parent is bus 5 at index 5.
Obviously, this additional battery will go into equation #58.
Aeq(5, Pc(3)) = -1
Aeq(5, Pd(3)) = 1
Aeq(23, qB(3)) = 1
Aeq(58, B(3)) = 1
Aeq(58, Pc(3)) = -delta_t*etta_C
Aeq(58, Pd(3)) = delta_t/etta_D
beq(58) = B0(3) = 0.053826
Battery number 4 is actually bus number 7.
Whose parent is bus 6 at index 6.
Obviously, this additional battery will go into equation #59.
Aeq(6, Pc(4)) = -1
Aeq(6, Pd(4)) = 1
Aeq(24, qB(4)) = 1
Aeq(59, B(4)) = 1
Aeq(59, Pc(4)) = -delta_t*etta_C
Aeq(59, Pd(4)) = delta_t/etta_D
beq(59) = B0(4) = 0.053826
Battery number 5 is actually bus number 9.
Whose parent is bus 8 at index 8.
Obviously, this additional battery will go into equation #60.
Aeq(8, Pc(5)) = -1
Aeq(8, Pd(5)) = 1
Aeq(26, qB(5)) = 1
Aeq(60, B(5)) = 1
Aeq(60, Pc(5)) = -delta_t*etta_C
Aeq(60, Pd(5)) = delta_t/etta_D
beq(60) = B0(5) = 0.053826
Battery number 6 is actually bus number 10.
Whose parent is bus 9 at index 9.
Obviously, this additional battery will go into equation #61.
Aeq(9, Pc(6)) = -1
Aeq(9, Pd(6)) = 1
Aeq(27, qB(6)) = 1
Aeq(61, B(6)) = 1
Aeq(61, Pc(6)) = -delta_t*etta_C
Aeq(61, Pd(6)) = delta_t/etta_D
beq(61) = B0(6) = 0.053826
Battery number 7 is actually bus number 11.
Whose parent is bus 8 at index 10.
Obviously, this additional battery will go into equation #62.
Aeq(10, Pc(7)) = -1
Aeq(10, Pd(7)) = 1
Aeq(28, qB(7)) = 1
Aeq(62, B(7)) = 1
Aeq(62, Pc(7)) = -delta_t*etta_C
Aeq(62, Pd(7)) = delta_t/etta_D
beq(62) = B0(7) = 0.053826
Battery number 8 is actually bus number 13.
Whose parent is bus 11 at index 12.
Obviously, this additional battery will go into equation #63.
Aeq(12, Pc(8)) = -1
Aeq(12, Pd(8)) = 1
Aeq(30, qB(8)) = 1
Aeq(63, B(8)) = 1
Aeq(63, Pc(8)) = -delta_t*etta_C
Aeq(63, Pd(8)) = delta_t/etta_D
beq(63) = B0(8) = 0.053826
Battery number 9 is actually bus number 14.
Whose parent is bus 13 at index 13.
Obviously, this additional battery will go into equation #64.
Aeq(13, Pc(9)) = -1
Aeq(13, Pd(9)) = 1
Aeq(31, qB(9)) = 1
Aeq(64, B(9)) = 1
Aeq(64, Pc(9)) = -delta_t*etta_C
Aeq(64, Pd(9)) = delta_t/etta_D
beq(64) = B0(9) = 0.053826
Battery number 10 is actually bus number 15.
Whose parent is bus 14 at index 14.
Obviously, this additional battery will go into equation #65.
Aeq(14, Pc(10)) = -1
Aeq(14, Pd(10)) = 1
Aeq(32, qB(10)) = 1
Aeq(65, B(10)) = 1
Aeq(65, Pc(10)) = -delta_t*etta_C
Aeq(65, Pd(10)) = delta_t/etta_D
beq(65) = B0(10) = 0.053826
Battery number 11 is actually bus number 16.
Whose parent is bus 15 at index 15.
Obviously, this additional battery will go into equation #66.
Aeq(15, Pc(11)) = -1
Aeq(15, Pd(11)) = 1
Aeq(33, qB(11)) = 1
Aeq(66, B(11)) = 1
Aeq(66, Pc(11)) = -delta_t*etta_C
Aeq(66, Pd(11)) = delta_t/etta_D
beq(66) = B0(11) = 0.053826
Battery number 12 is actually bus number 17.
Whose parent is bus 16 at index 16.
Obviously, this additional battery will go into equation #67.
Aeq(16, Pc(12)) = -1
Aeq(16, Pd(12)) = 1
Aeq(34, qB(12)) = 1
Aeq(67, B(12)) = 1
Aeq(67, Pc(12)) = -delta_t*etta_C
Aeq(67, Pd(12)) = delta_t/etta_D
beq(67) = B0(12) = 0.053826
